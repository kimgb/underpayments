<% content_for :title, "Am I Underpaid?" %>

<main>
  <section id="introduction">
    <h3 role="presentation"><%= t('start.intro') %></h3>
    <p>Hello there. If you've done <strong>work lately on a farm</strong>, I'm here to help you find out if you've been ripped off&mdash;and help you get your money, if you want.</p>

    <p>First things first. Just so we're clear, the minimum wage, with certain <a class="modal-open" data-content="exceptions">exceptions</a>, for a casual<sup>[<a class="modal-open" data-content="casual">what's that?</a>]</sup> farm worker is <strong>$21.61 per hour</strong>.</p>

    <p>So, you think you've been underpaid. Let's find out.</p>
  </section>

  <form id="frmCalculator" class="form" method="POST" action="#">
    <div class="form-group">
      <label for="inputHours">How many hours did you work, all up?</label>
      <input id="inputHours" class="form-control" name="calc[hours]" type="number" min="0" step="any" required />
    </div>

    <div class="form-group">
      <label for="inputPay">And how much were you paid, per hour?</label>
      <input id="inputPay" class="form-control" name="calc[pay]" type="number" min="0" step="0.01" required />
    </div>

    <output id="frmOutput"></output>

    <div class="align-right">
      <button type="submit" id="btnCalc" class="btn btn-warning">How Much Am I Underpaid?</button>
      <%= link_to "Let's Fix This", new_user_path, id: "btnAction", class: "btn btn-success collapse" %>
    </div>
  </form>
</main>

<script type="text/javascript">
  $(document).ready(function(){
    $("#frmCalculator").on("submit", function(e){
      e.preventDefault();

      var awardMin = 21.61,
          hourlyPay = $("#inputPay").val(),
          hours = $("#inputHours").val();

      var awardWages = (awardMin * hours).toFixed(2),
          actualWages = (hourlyPay * hours).toFixed(2);

      var output = "By the numbers, you were paid $" + actualWages + ", and you should have been paid a bare minimum of $" + awardWages + ".";

      if (awardWages > actualWages){
        output = output + " This mean you were underpaid $" + (awardWages - actualWages).toFixed(2) + ". Want to get it back? Tap 'Let's Fix This', below.";

        $("#btnCalc").addClass("collapse");
        $("#btnAction").removeClass("collapse");
      }

      $("#frmOutput")[0].value = output;
    })
  })
</script>
